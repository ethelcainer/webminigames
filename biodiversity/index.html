<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biodiversity Taxonomist | Form 2 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --paper-bg: #fffcf2;
            --ink-blue: #2563eb;
            --ink-black: #1e293b;
        }

        @keyframes moveBg {
            from { background-position: 0 0; }
            to { background-position: 40px 40px; }
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #e5e7eb;
            background-image: radial-gradient(#9ca3af 1px, transparent 1px);
            background-size: 20px 20px;
            overflow: hidden;
            touch-action: none;
            animation: moveBg 8s linear infinite;
        }

        .notebook-page {
            background-color: var(--paper-bg);
            background-image: linear-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 100% 30px;
            border: 4px solid var(--ink-black);
            box-shadow: 15px 15px 0px rgba(0,0,0,0.1);
            position: relative;
        }

        .drop-zone {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 3px dashed #cbd5e1;
        }

        .drop-zone.drag-over {
            transform: scale(1.05);
            background: rgba(37, 99, 235, 0.1);
            border-color: var(--ink-blue);
        }

        .organism-card {
            cursor: grab;
            transition: transform 0.2s;
            filter: drop-shadow(4px 4px 0px rgba(0,0,0,0.1));
        }

        .organism-card:active { cursor: grabbing; transform: scale(1.05) rotate(2deg); }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .animate-pop { animation: popIn 0.4s forwards; }
        .shake { animation: shake 0.2s ease-in-out 0s 2; }

        .success-flash {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            background: rgba(34, 197, 94, 0.3);
            animation: ripple 0.6s ease-out;
        }

        @keyframes ripple {
            from { transform: scale(0); opacity: 1; }
            to { transform: scale(4); opacity: 0; }
        }

        .hidden { display: none; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="max-w-6xl w-full h-[85vh] notebook-page rounded-[40px] flex flex-col overflow-hidden">
        
        <div class="p-6 border-b-4 border-slate-800 bg-white/50 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-black text-slate-800 tracking-tight">BIODIVERSITY <span class="text-blue-600">LAB</span></h1>
                <p class="text-slate-500 font-bold">Chapter 1: Classification of Organisms</p>
            </div>
            <div class="flex items-center space-x-6">
                <div id="lives-display" class="flex space-x-1">
                    </div>
                <div class="text-right border-l-2 border-slate-200 pl-6">
                    <div id="score-label" class="text-xs font-black text-slate-400 uppercase">Classified</div>
                    <div id="progress-text" class="text-2xl font-black text-blue-600">0 / 15</div>
                </div>
            </div>
        </div>

        <div class="flex-1 flex overflow-hidden">
            <div class="w-2/5 border-r-4 border-slate-800 p-6 bg-slate-50/50 flex flex-col">
                <div class="mb-4 bg-yellow-100 border-2 border-yellow-400 p-3 rounded-xl">
                    <p class="text-sm font-bold text-yellow-800">OBSERVE the field notes and drag the specimen!</p>
                </div>
                <div id="organism-pool" class="flex-1 flex flex-col items-center justify-center relative">
                </div>
            </div>

            <div class="w-3/5 p-6 grid grid-cols-2 gap-4 overflow-y-auto">
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="mammal">
                    <div class="w-12 h-12 bg-orange-100 rounded-full mb-2 flex items-center justify-center text-orange-600 font-black">M</div>
                    <span class="font-black text-slate-700">MAMMALS</span>
                    <span class="text-[10px] text-slate-400">Give birth, hair/fur, homeothermic</span>
                </div>
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="bird">
                    <div class="w-12 h-12 bg-blue-100 rounded-full mb-2 flex items-center justify-center text-blue-600 font-black">B</div>
                    <span class="font-black text-slate-700">BIRDS</span>
                    <span class="text-[10px] text-slate-400">Feathers, hard shells, homeothermic</span>
                </div>
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="reptile">
                    <div class="w-12 h-12 bg-emerald-100 rounded-full mb-2 flex items-center justify-center text-emerald-600 font-black">R</div>
                    <span class="font-black text-slate-700">REPTILES</span>
                    <span class="text-[10px] text-slate-400">Scaly skin, leathery eggs, poikilothermic</span>
                </div>
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="amphibian">
                    <div class="w-12 h-12 bg-purple-100 rounded-full mb-2 flex items-center justify-center text-purple-600 font-black">A</div>
                    <span class="font-black text-slate-700">AMPHIBIANS</span>
                    <span class="text-[10px] text-slate-400">Moist skin, land & water, poikilothermic</span>
                </div>
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="fish">
                    <div class="w-12 h-12 bg-sky-100 rounded-full mb-2 flex items-center justify-center text-sky-600 font-black">F</div>
                    <span class="font-black text-slate-700">FISH</span>
                    <span class="text-[10px] text-slate-400">Gills, fins, slimy scales, poikilothermic</span>
                </div>
                <div class="drop-zone rounded-3xl p-4 flex flex-col items-center justify-center text-center bg-white" data-group="invertebrate">
                    <div class="w-12 h-12 bg-rose-100 rounded-full mb-2 flex items-center justify-center text-rose-600 font-black">I</div>
                    <span class="font-black text-slate-700">INVERTEBRATES</span>
                    <span class="text-[10px] text-slate-400">No backbone, many have exoskeletons</span>
                </div>
            </div>
        </div>

        <div id="overlay" class="absolute inset-0 z-50 bg-slate-900/80 backdrop-blur-md flex items-center justify-center p-6">
            <div class="max-w-md w-full bg-white rounded-[40px] border-4 border-slate-800 p-10 text-center animate-pop">
                <div id="overlay-icon" class="w-24 h-24 bg-blue-500 rounded-3xl mx-auto mb-6 flex items-center justify-center shadow-[0_8px_0_#1e3a8a]">
                    <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
                </div>
                <h2 id="overlay-title" class="text-4xl font-black text-slate-800 mb-2">TAXONOMY MISSION</h2>
                <p id="overlay-msg" class="text-slate-500 font-bold mb-8">Can you classify 15 Malaysian species into their correct biological groups?</p>
                <button onclick="startGame()" class="w-full py-5 bg-yellow-400 hover:bg-yellow-300 text-slate-900 font-black text-2xl rounded-2xl border-b-8 border-yellow-600 transition-all active:border-b-0 active:translate-y-2">START FIELDWORK</button>
            </div>
        </div>

        <div id="win-screen" class="absolute inset-0 z-50 bg-blue-600 flex flex-col items-center justify-center text-white p-6 hidden">
            <h2 class="text-6xl font-black mb-4">EXPERT TAXONOMIST!</h2>
            <p class="text-2xl font-bold mb-8">You've successfully classified the local biodiversity.</p>
            <button onclick="location.reload()" class="px-10 py-4 bg-white text-blue-600 font-black text-xl rounded-2xl shadow-xl">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(freq, type = 'sine', duration = 0.1) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        const organisms = [
            { 
                name: "Asian Elephant", 
                group: "mammal", 
                color: "#64748b", 
                note: "Possesses a trunk, thick leathery skin, and mammary glands.",
                svg: `<path d="M20 60 Q20 30 50 30 Q80 30 80 60 L85 85 L15 85 Z" fill="currentColor"/><path d="M75 55 Q95 55 95 85" stroke="currentColor" stroke-width="6" fill="none"/><circle cx="40" cy="50" r="3" fill="white"/><path d="M25 40 Q15 40 10 60" stroke="currentColor" stroke-width="8" fill="none"/>` 
            },
            { 
                name: "Crested Eagle", 
                group: "bird", 
                color: "#78350f", 
                note: "Equipped with powerful talons, a sharp beak, and feathers.",
                svg: `<path d="M30 40 L50 20 L70 40 L50 80 Z" fill="currentColor"/><path d="M10 45 Q30 30 50 45 Q70 30 90 45" stroke="currentColor" stroke-width="4" fill="none"/><circle cx="50" cy="35" r="2" fill="white"/><path d="M45 20 L55 20 L50 28 Z" fill="#fbbf24"/>` 
            },
            { 
                name: "Green Turtle", 
                group: "reptile", 
                color: "#166534", 
                note: "Lays eggs on sandy beaches; body protected by a hard carapace.",
                svg: `<path d="M25 65 A25 25 0 0 1 75 65 Z" fill="currentColor"/><path d="M30 65 L20 75 M70 65 L80 75 M40 75 L35 85 M60 75 L65 85" stroke="currentColor" stroke-width="5" stroke-linecap="round"/><circle cx="82" cy="65" r="7" fill="currentColor"/>` 
            },
            { 
                name: "Bullfrog", 
                group: "amphibian", 
                color: "#22c55e", 
                note: "Breaths through moist skin; starts life as a water-dwelling larva.",
                svg: `<ellipse cx="50" cy="65" rx="35" ry="20" fill="currentColor"/><circle cx="30" cy="45" r="10" fill="currentColor"/><circle cx="70" cy="45" r="10" fill="currentColor"/><circle cx="30" cy="45" r="3" fill="white"/><circle cx="70" cy="45" r="3" fill="white"/><path d="M35 75 Q50 85 65 75" stroke="white" stroke-width="2" fill="none"/>` 
            },
            { 
                name: "Clownfish", 
                group: "fish", 
                color: "#f97316", 
                note: "Body covered in scales and mucus; uses gills for underwater respiration.",
                svg: `<path d="M10 50 Q50 15 90 50 Q50 85 10 50" fill="currentColor"/><path d="M90 50 L105 35 L105 65 Z" fill="currentColor"/><rect x="35" y="25" width="12" height="50" fill="white"/><rect x="65" y="32" width="10" height="36" fill="white"/>` 
            },
            { 
                name: "Monarch", 
                group: "invertebrate", 
                color: "#ec4899", 
                note: "Undergoes metamorphosis; has an exoskeleton and jointed legs.",
                svg: `<path d="M50 30 Q80 0 95 40 Q80 60 50 50 Q20 60 5 40 Q20 0 50 30" fill="currentColor" stroke="#1e293b" stroke-width="2"/><circle cx="50" cy="45" r="3" fill="#1e293b"/><path d="M50 30 L45 15 M50 30 L55 15" stroke="#1e293b" stroke-width="2"/>` 
            },
            { 
                name: "Spider Hunter", 
                group: "invertebrate", 
                color: "#1e293b", 
                note: "Lacks a backbone; has eight jointed legs and multiple eyes.",
                svg: `<circle cx="50" cy="50" r="18" fill="currentColor"/><path d="M35 40 L10 20 M35 50 L5 50 M35 60 L10 80 M65 40 L90 20 M65 50 L95 50 M65 60 L90 80" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>` 
            },
            { 
                name: "Fruit Bat", 
                group: "mammal", 
                color: "#334155", 
                note: "The only group that truly flies; feeds young with milk.",
                svg: `<path d="M10 40 Q30 20 50 50 Q70 20 90 40 L50 75 Z" fill="currentColor"/><circle cx="50" cy="45" r="12" fill="currentColor"/><path d="M45 35 L40 25 M55 35 L60 25" stroke="currentColor" stroke-width="3"/>` 
            },
            { 
                name: "King Cobra", 
                group: "reptile", 
                color: "#064e3b", 
                note: "Body covered in dry scales; cold-blooded and lays leathery eggs.",
                svg: `<path d="M20 85 Q40 50 60 85 Q80 50 90 70" fill="none" stroke="currentColor" stroke-width="12" stroke-linecap="round"/><path d="M85 70 Q95 50 105 70" fill="currentColor"/><circle cx="95" cy="65" r="2" fill="white"/>` 
            },
            { 
                name: "Penguin", 
                group: "bird", 
                color: "#0f172a", 
                note: "Streamlined body for swimming; has feathers but cannot fly.",
                svg: `<ellipse cx="50" cy="60" rx="22" ry="38" fill="currentColor"/><ellipse cx="50" cy="65" rx="14" ry="28" fill="white"/><circle cx="50" cy="28" r="15" fill="currentColor"/><path d="M48 28 L52 28 L50 36 Z" fill="orange"/>` 
            },
            { 
                name: "Great White", 
                group: "fish", 
                color: "#475569", 
                note: "Cartilaginous skeleton; streamlined body with fins and gills.",
                svg: `<path d="M5 60 Q50 25 95 60 Q50 85 5 60" fill="currentColor"/><path d="M50 40 L70 15 L65 40 Z" fill="currentColor"/><path d="M90 60 L105 45 L105 75 Z" fill="currentColor"/>` 
            },
            { 
                name: "Fire Salamander", 
                group: "amphibian", 
                color: "#facc15", 
                note: "Scaleless, moist skin; lives on land but reproduces in water.",
                svg: `<path d="M20 50 Q50 20 80 50" fill="none" stroke="#1e293b" stroke-width="12" stroke-linecap="round"/><circle cx="85" cy="50" r="10" fill="#1e293b"/><circle cx="20" cy="50" r="5" fill="#1e293b"/>` 
            },
            { 
                name: "Mud Crab", 
                group: "invertebrate", 
                color: "#991b1b", 
                note: "Hard calcified exoskeleton; jointed appendages and no backbone.",
                svg: `<ellipse cx="50" cy="65" rx="30" ry="20" fill="currentColor"/><path d="M25 55 L10 30 M75 55 L90 30" stroke="currentColor" stroke-width="8" stroke-linecap="round"/><circle cx="40" cy="50" r="4" fill="currentColor"/><circle cx="60" cy="50" r="4" fill="currentColor"/>` 
            },
            { 
                name: "Blue Whale", 
                group: "mammal", 
                color: "#1d4ed8", 
                note: "Marine dweller that breathes air; warm-blooded and gives birth.",
                svg: `<path d="M10 65 Q50 20 95 65 L85 85 L15 85 Z" fill="currentColor"/><path d="M95 65 L110 50 L110 80 Z" fill="currentColor"/><path d="M50 35 Q55 20 60 35" stroke="white" stroke-width="2" fill="none"/>` 
            },
            { 
                name: "Hornbill", 
                group: "bird", 
                color: "#1e293b", 
                note: "Distinctive large bill; body covered in feathers, lays eggs.",
                svg: `<rect x="35" y="35" width="30" height="50" rx="15" fill="currentColor"/><circle cx="50" cy="30" r="18" fill="currentColor"/><path d="M60 25 L90 35 L60 45 Z" fill="#fbbf24"/><circle cx="55" cy="25" r="3" fill="white"/>` 
            }
        ];

        let score = 0;
        let lives = 3;
        let currentOrganism = null;
        let pool = [...organisms];

        function startGame() {
            document.getElementById('overlay').classList.add('hidden');
            score = 0;
            lives = 3;
            pool = [...organisms].sort(() => Math.random() - 0.5);
            updateProgress();
            updateLivesUI();
            spawnOrganism();
            playSound(440, 'sine', 0.2);
        }

        function updateProgress() {
            document.getElementById('progress-text').innerText = `${score} / ${organisms.length}`;
        }

        function updateLivesUI() {
            const container = document.getElementById('lives-display');
            container.innerHTML = '';
            for(let i=0; i<3; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = `<svg class="w-8 h-8 ${i < lives ? 'text-rose-500' : 'text-slate-200'}" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>`;
                container.appendChild(heart);
            }
        }

        function spawnOrganism() {
            const poolEl = document.getElementById('organism-pool');
            poolEl.innerHTML = '';
            
            if (pool.length === 0) {
                showWin();
                return;
            }

            const data = pool.pop();
            currentOrganism = data;

            const card = document.createElement('div');
            card.className = 'organism-card w-64 h-80 bg-white border-4 border-slate-800 rounded-3xl flex flex-col items-center justify-between p-6 animate-pop';
            card.draggable = true;
            card.innerHTML = `
                <div class="flex-1 flex items-center justify-center">
                    <svg viewBox="0 0 110 110" class="w-40 h-40" style="color: ${data.color}">
                        ${data.svg}
                    </svg>
                </div>
                <div class="text-center">
                    <span class="font-black text-slate-800 uppercase tracking-tighter text-lg">${data.name}</span>
                    <p class="text-[11px] leading-tight font-bold text-slate-400 mt-2 bg-slate-50 p-2 rounded-lg italic">" ${data.note} "</p>
                </div>
            `;

            card.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', data.group);
                card.style.opacity = '0.5';
                playSound(600, 'sine', 0.05);
            });

            card.addEventListener('dragend', () => {
                card.style.opacity = '1';
            });

            poolEl.appendChild(card);
        }

        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('drag-over');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                const group = e.dataTransfer.getData('text/plain');
                const targetGroup = zone.dataset.group;

                if (group === targetGroup) {
                    handleCorrect(zone);
                } else {
                    handleWrong();
                }
            });
        });

        function handleCorrect(zone) {
            score++;
            updateProgress();
            playSound(880, 'sine', 0.2);
            const flash = document.createElement('div');
            flash.className = 'success-flash h-20 w-20';
            zone.appendChild(flash);
            setTimeout(() => flash.remove(), 600);
            spawnOrganism();
        }

        function handleWrong() {
            lives--;
            updateLivesUI();
            playSound(120, 'sawtooth', 0.3);
            const card = document.querySelector('.organism-card');
            card.classList.add('shake');
            card.style.borderColor = '#ef4444';
            
            if(lives <= 0) {
                setTimeout(showGameOver, 500);
            } else {
                setTimeout(() => {
                    card.classList.remove('shake');
                    card.style.borderColor = '#1e293b';
                }, 500);
            }
        }

        function showGameOver() {
            const overlay = document.getElementById('overlay');
            const icon = document.getElementById('overlay-icon');
            overlay.classList.remove('hidden');
            icon.classList.replace('bg-blue-500', 'bg-rose-500');
            document.getElementById('overlay-title').innerText = "MISSION FAILED";
            document.getElementById('overlay-msg').innerText = "The specimens were incorrectly filed. Review your biology notes and try again!";
            document.querySelector('#overlay button').innerText = "RETRY FIELDWORK";
        }

        function showWin() {
            document.getElementById('win-screen').classList.remove('hidden');
            playSound(523, 'sine', 0.5);
        }

        // Mobile Support
        let touchTarget = null;
        document.addEventListener('touchstart', (e) => {
            if (e.target.closest('.organism-card')) {
                touchTarget = e.target.closest('.organism-card');
            }
        }, {passive: false});

        document.addEventListener('touchmove', (e) => {
            if (!touchTarget) return;
            e.preventDefault();
            const touch = e.touches[0];
            touchTarget.style.position = 'fixed';
            touchTarget.style.left = touch.clientX - 128 + 'px';
            touchTarget.style.top = touch.clientY - 160 + 'px';
            touchTarget.style.zIndex = '1000';
        }, {passive: false});

        document.addEventListener('touchend', (e) => {
            if (!touchTarget) return;
            const touch = e.changedTouches[0];
            touchTarget.style.display = 'none';
            const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY)?.closest('.drop-zone');
            touchTarget.style.display = 'flex';
            
            if (dropTarget) {
                const group = currentOrganism.group;
                if (group === dropTarget.dataset.group) handleCorrect(dropTarget);
                else handleWrong();
            }
            touchTarget.style.position = 'static';
            touchTarget = null;
        });

    </script>
</body>
</html>