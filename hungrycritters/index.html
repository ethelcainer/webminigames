<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hungry Critters: What's for Lunch?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        /* --- Global & Typography --- */
        body {
            font-family: 'Fredoka One', cursive;
            background-color: #2d3748;
            overflow: hidden;
            touch-action: none;
            user-select: none;
        }

        .cartoon-text {
            -webkit-text-stroke: 2px black;
            color: white;
            text-shadow: 3px 3px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }

        #game-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: radial-gradient(circle at center bottom, #4fd1c5 0%, #22543d 80%);
        }

        /* --- UI Bar (Top) --- */
        #ui-bar {
            position: absolute;
            top: 20px; left: 20px; right: 20px;
            display: flex;
            justify-content: space-between;
            z-index: 50;
        }
        
        .ui-bubble {
            background: rgba(0,0,0,0.4);
            border: 3px solid rgba(255,255,255,0.8);
            border-radius: 30px;
            padding: 10px 25px;
            font-size: 1.5rem;
            box-shadow: 0 6px 0 rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- The Animal Stage --- */
        #animal-stage {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            /* Default spotlight state */
            background: radial-gradient(circle at center, rgba(255,255,255,0.2) 0%, transparent 70%);
            /* Smooth transition for color changes */
            transition: background 0.3s ease;
        }

        /* NEW: The red state for incorrect food */
        .stage-red {
            background: radial-gradient(circle at center, rgba(239, 68, 68, 0.7) 0%, transparent 80%) !important;
        }

        #animal-emoji {
            font-size: 13rem;
            filter: drop-shadow(0 15px 25px rgba(0,0,0,0.4));
            transition: transform 0.2s;
            z-index: 10;
            margin-top: 20px;
        }

        .diet-badge {
            background: #fbbf24;
            color: #78350f;
            border: 4px solid #fff;
            padding: 10px 25px;
            border-radius: 50px;
            font-size: 1.5rem;
            box-shadow: 0 8px 0 #d97706;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: pop-in 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop-in { from { transform: scale(0); } to { transform: scale(1); } }

        /* --- Mouth Zone & Animations --- */
        #mouth-zone {
            position: absolute;
            top: 58%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            border-radius: 50%;
            z-index: 20;
            transition: all 0.2s;
        }
        
        #mouth-zone.drag-over {
            background: rgba(255,255,255,0.4);
            box-shadow: 0 0 50px white, inset 0 0 20px white;
            border: 4px dashed white;
        }

        @keyframes chew {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            50% { transform: scale(0.9) rotate(5deg); }
            75% { transform: scale(1.05) rotate(-3deg); }
        }
        .chewing { animation: chew 0.7s ease-in-out; }

        @keyframes disgust {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-25px) rotate(-15deg); }
            40% { transform: translateX(25px) rotate(15deg); }
            60% { transform: translateX(-15px) rotate(-5deg); }
            80% { transform: translateX(15px) rotate(5deg); }
        }
        .disgusted { animation: disgust 0.6s ease-in-out; }

        /* --- Food Tray Area --- */
        #food-tray {
            height: 180px;
            background-color: #c53030; 
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent),
                linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
            background-size: 40px 40px;
            border-top: 8px solid #7c2d12;
            box-shadow: inset 0 10px 30px rgba(0,0,0,0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            padding: 10px;
            position: relative;
            z-index: 100;
        }

        .food-container {
            width: 90px;
            height: 90px;
            background: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4rem;
            cursor: grab;
            border: 4px solid #fbbf24;
            box-shadow: 0 6px 0 #d97706, 0 10px 10px rgba(0,0,0,0.2);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .food-container:hover {
            transform: translateY(-10px) scale(1.1);
            box-shadow: 0 16px 0 #d97706, 0 20px 20px rgba(0,0,0,0.3);
        }

        .food-container:active { 
            cursor: grabbing; 
            transform: scale(0.9);
            box-shadow: 0 2px 0 #d97706;
        }

        /* Particles */
        .crumb {
            position: absolute;
            width: 12px; height: 12px;
            border-radius: 50%;
            pointer-events: none;
            border: 2px solid rgba(0,0,0,0.2);
            animation: crumb-fly 0.6s ease-out forwards;
            z-index: 30;
        }
        @keyframes crumb-fly {
            to { transform: translate(var(--tx), var(--ty)) scale(0) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="ui-bar">
        <div class="ui-bubble cartoon-text">
            <span>üêæ</span> <span id="animal-name">Loading...</span>
        </div>
        <div class="ui-bubble cartoon-text">
            <span>‚≠ê</span> <span id="score" class="text-yellow-300">0</span>
        </div>
    </div>

    <div id="animal-stage">
        <div id="diet-hint" class="diet-badge mb-4">???</div>
        <div id="animal-emoji">ü¶Å</div>
        <div id="mouth-zone"></div>
    </div>

    <div id="food-tray">
        </div>
</div>

<script>
    // --- Game Data ---
    const ANIMALS = [
        { name: "Leo Lion", emoji: "ü¶Å", type: "carnivore", hint: "Meat Only!" },
        { name: "Bella Cow", emoji: "üêÆ", type: "herbivore", hint: "Plants Only!" },
        { name: "Oli Bear", emoji: "üêª", type: "omnivore", hint: "Plants & Meat!" },
        { name: "Rex T-Rex", emoji: "ü¶ñ", type: "carnivore", hint: "MEAT!!!" },
        { name: "Sally Sheep", emoji: "üêë", type: "herbivore", hint: "Yummy Grass!" },
        { name: "Coco Monkey", emoji: "üêµ", type: "omnivore", hint: "Fruits & Bugs!" }
    ];

    const FOODS = [
        { id: 'meat1', emoji: "ü•©", type: "carnivore", color: "#ef4444" },
        { id: 'plant1', emoji: "ü•¶", type: "herbivore", color: "#22c55e" },
        { id: 'meat2', emoji: "üçó", type: "carnivore", color: "#ea580c" },
        { id: 'plant2', emoji: "ü•ï", type: "herbivore", color: "#f97316" },
        { id: 'meat3', emoji: "üêü", type: "carnivore", color: "#3b82f6" },
        { id: 'plant3', emoji: "üçé", type: "herbivore", color: "#ef4444" },
        { id: 'plant4', emoji: "üçå", type: "herbivore", color: "#eab308" }
    ];

    // --- State ---
    let currentAnimal = null;
    let score = 0;
    let roundCount = 0;

    // --- DOM Elements ---
    const animalEmojiEl = document.getElementById('animal-emoji');
    const animalNameEl = document.getElementById('animal-name');
    const dietHintEl = document.getElementById('diet-hint');
    const foodTrayEl = document.getElementById('food-tray');
    const mouthZoneEl = document.getElementById('mouth-zone');
    const scoreEl = document.getElementById('score');
    const stageEl = document.getElementById('animal-stage');

    // --- Audio Synth ---
    let audioCtx = null;
    function initAudio() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
    
    function playSound(type) {
        initAudio(); if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);

        if (type === 'chomp') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(250, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.25);
            gain.gain.setValueAtTime(1, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
            osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        } else if (type === 'yuck') {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.4);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.4);
            osc.start(); osc.stop(audioCtx.currentTime + 0.4);
        } else if (type === 'yay') {
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(600, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(1200, audioCtx.currentTime + 0.3);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
            osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- Game Logic ---

    function loadRound() {
        currentAnimal = ANIMALS[roundCount % ANIMALS.length];
        
        animalNameEl.textContent = currentAnimal.name;
        animalEmojiEl.textContent = currentAnimal.emoji;
        dietHintEl.textContent = currentAnimal.hint;
        
        // Reset Animations and Background
        animalEmojiEl.classList.remove('chewing', 'disgusted');
        stageEl.classList.remove('stage-red');
        
        // Spawn Food in new containers
        foodTrayEl.innerHTML = '';
        const shuffledFood = [...FOODS].sort(() => 0.5 - Math.random());
        const roundFoods = shuffledFood.slice(0, 4);

        roundFoods.forEach(food => {
            const container = document.createElement('div');
            container.classList.add('food-container');
            container.draggable = true;
            container.textContent = food.emoji;
            container.dataset.type = food.type;
            container.dataset.color = food.color;
            
            container.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', food.type);
                e.dataTransfer.setData('color', food.color);
                setTimeout(() => e.target.style.visibility = 'hidden', 0);
            });
             container.addEventListener('dragend', (e) => {
                 e.target.style.visibility = 'visible';
            });
            
            foodTrayEl.appendChild(container);
        });
    }

    function handleFeed(foodType, foodColor) {
        let isYummy = false;
        if (currentAnimal.type === 'omnivore') isYummy = true;
        else if (currentAnimal.type === foodType) isYummy = true;

        if (isYummy) {
            // SUCCESS
            playSound('chomp');
            animalEmojiEl.classList.add('chewing');
            score += 10;
            scoreEl.textContent = score;
            createCrumbs(foodColor);
            
            setTimeout(() => {
                playSound('yay');
                roundCount++;
                loadRound();
            }, 1100);

        } else {
            // FAILURE - RED BACKGROUND
            playSound('yuck');
            animalEmojiEl.classList.add('disgusted');
            stageEl.classList.add('stage-red'); // Turn background red

            // Remove red background after animation finishes
            setTimeout(() => {
                 animalEmojiEl.classList.remove('disgusted');
                 stageEl.classList.remove('stage-red');
            }, 600);
        }
    }
    
    function createCrumbs(color) {
        const rect = mouthZoneEl.getBoundingClientRect();
        for(let i=0; i<12; i++) {
            const crumb = document.createElement('div');
            crumb.classList.add('crumb');
            crumb.style.backgroundColor = color;
            crumb.style.left = (rect.left + rect.width/2) + 'px';
            crumb.style.top = (rect.top + rect.height/2) + 'px';
            
            const angle = Math.random() * Math.PI * 2;
            const dist = 60 + Math.random() * 80;
            crumb.style.setProperty('--tx', `${Math.cos(angle) * dist}px`);
            crumb.style.setProperty('--ty', `${Math.sin(angle) * dist + 150}px`);
            
            document.body.appendChild(crumb);
            setTimeout(() => crumb.remove(), 600);
        }
    }

    // --- Drag & Drop Handlers ---
    mouthZoneEl.addEventListener('dragover', (e) => {
        e.preventDefault();
        mouthZoneEl.classList.add('drag-over');
    });

    mouthZoneEl.addEventListener('dragleave', () => {
        mouthZoneEl.classList.remove('drag-over');
    });

    mouthZoneEl.addEventListener('drop', (e) => {
        e.preventDefault();
        mouthZoneEl.classList.remove('drag-over');
        const foodType = e.dataTransfer.getData('text/plain');
        const foodColor = e.dataTransfer.getData('color');
        
        const draggedEl = document.querySelector(`.food-container[style*="visibility: hidden"]`);
        if (draggedEl) draggedEl.remove();

        handleFeed(foodType, foodColor);
    });

    // --- Start Game ---
    loadRound();

</script>

</body>
</html>