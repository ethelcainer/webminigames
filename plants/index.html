<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garden Hero | Standard 3 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            overflow: hidden;
            background: #e0f7fa; /* Vibrant Light Cyan */
        }
        .bouncy-font { font-family: 'Fredoka One', cursive; }
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px); }
        
        .parallax-layer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 110%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .tool-btn {
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
            border: 2px solid #e2e8f0; /* Light Gray border */
        }
        .tool-btn:hover { transform: translateY(-5px); border-color: #22c55e; box-shadow: 0 10px 15px -3px rgba(34, 197, 94, 0.3); }
        .tool-btn:active { transform: scale(0.95); }

        .floating { animation: floating 6s ease-in-out infinite; }
        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        #progress-inner { transition: width 0.6s cubic-bezier(0.17, 0.67, 0.83, 0.67); }

        #overlay::-webkit-scrollbar { width: 8px; }
        #overlay::-webkit-scrollbar-track { background: #f1f1f1; }
        #overlay::-webkit-scrollbar-thumb { background: #10b981; border-radius: 10px; }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            pointer-events: none;
            z-index: 100;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-6">

    <div class="fixed inset-0 z-[-3] bg-gradient-to-b from-cyan-300 via-blue-200 to-green-100"></div>
    <div id="sun" class="fixed top-12 right-24 w-24 h-24 bg-yellow-400 rounded-full blur-sm opacity-80 z-[-2] shadow-[0_0_60px_rgba(250,204,21,0.8)]"></div>
    
    <div class="parallax-layer opacity-40" id="layer-far">
        <svg viewBox="0 0 1200 500" preserveAspectRatio="none" class="w-full h-3/5 absolute bottom-0">
            <defs>
                <symbol id="pine-far" viewBox="0 0 40 100">
                    <path d="M20 10 L35 40 L28 40 L38 70 L25 70 L25 90 L15 90 L15 70 L2 70 L12 40 L5 40 Z" fill="#047857"/> </symbol>
            </defs>
            <path d="M0,450 Q300,400 600,450 T1200,450 L1200,500 L0,500 Z" fill="#065f46"/>
            <use href="#pine-far" x="50" y="300" width="80" height="150" />
            <use href="#pine-far" x="250" y="270" width="100" height="180" />
            <use href="#pine-far" x="500" y="310" width="70" height="140" />
            <use href="#pine-far" x="750" y="280" width="110" height="170" />
            <use href="#pine-far" x="1000" y="300" width="90" height="150" />
        </svg>
    </div>

    <div class="parallax-layer" id="layer-mid">
        <svg viewBox="0 0 1200 500" preserveAspectRatio="none" class="w-full h-3/5 absolute bottom-0">
            <defs>
                <symbol id="pine-mid" viewBox="0 0 40 100">
                    <path d="M20 5 L40 45 L32 45 L40 85 L0 85 L8 45 L0 45 Z" fill="#15803d"/> <rect x="17" y="85" width="6" height="15" fill="#713f12"/> </symbol>
            </defs>
            <path d="M0,480 Q300,430 600,480 T1200,480 L1200,500 L0,500 Z" fill="#166534"/>
            <use href="#pine-mid" x="150" y="330" width="100" height="120" />
            <use href="#pine-mid" x="400" y="310" width="120" height="140" />
            <use href="#pine-mid" x="700" y="340" width="90" height="110" />
            <use href="#pine-mid" x="950" y="320" width="130" height="130" />
        </svg>
    </div>

    <div id="game-container" class="relative w-full max-w-5xl glass-card rounded-[3rem] border-4 border-green-300 shadow-2xl overflow-hidden aspect-video flex flex-col">
        
        <div class="px-10 py-6 flex justify-between items-center border-b-4 border-green-100 bg-white">
            <div class="flex flex-col gap-2">
                <h1 class="text-4xl bouncy-font text-green-600 drop-shadow-sm">Garden Hero</h1>
                <div class="w-56 h-3 bg-green-100 rounded-full overflow-hidden border border-green-200">
                    <div id="progress-inner" class="h-full bg-green-500 w-0 shadow-[inset_0_1px_2px_rgba(0,0,0,0.1)]"></div>
                </div>
            </div>

            <div class="flex gap-16 items-center">
                <div class="flex flex-col items-center">
                    <span class="text-xs uppercase font-black text-gray-500 tracking-[0.2em] mb-1">Score</span>
                    <p id="score" class="text-5xl bouncy-font text-orange-500 drop-shadow-sm">0</p>
                </div>
                <div class="flex flex-col items-center">
                    <span class="text-xs uppercase font-black text-gray-500 tracking-[0.2em] mb-1">Lives</span>
                    <div id="health-icons" class="flex gap-2"></div>
                </div>
            </div>
        </div>

        <div class="flex-grow relative flex items-center justify-center bg-gradient-to-b from-blue-50 to-green-50">
            <div id="plant-stage" class="relative w-72 h-72 flex flex-col items-center justify-end z-10 floating"></div>

            <div id="hint-bubble" class="absolute top-8 right-12 bg-white px-6 py-5 rounded-2xl shadow-xl border-2 border-green-200 max-w-[260px] opacity-0 scale-90">
                <p id="hint-text" class="text-green-800 font-bold text-base leading-snug text-center"></p>
            </div>

            <div class="absolute bottom-16 w-48 h-6 bg-black/10 rounded-[50%] blur-xl"></div>
        </div>

        <div id="tool-belt" class="px-10 py-8 grid grid-cols-6 gap-6 bg-white border-t-4 border-green-100"></div>
    </div>

    <div id="overlay" class="fixed inset-0 bg-white flex flex-col items-center z-50 p-10 text-center overflow-y-auto">
        <div class="max-w-2xl my-auto">
            <h1 class="text-7xl bouncy-font text-green-500 mb-2 drop-shadow-md">Garden Hero</h1>
            <p class="text-gray-600 text-xl mb-10 font-bold">Identify how each plant reproduces to save the garden!</p>
            
            <div id="info-grid" class="grid grid-cols-3 gap-5 mb-10"></div>

            <button onclick="startGame()" class="tool-btn bg-green-500 hover:bg-green-600 text-white px-16 py-5 rounded-full text-3xl bouncy-font shadow-[0_8px_0_#15803d] transition-all active:translate-y-2 active:shadow-none">
                START MISSION
            </button>
        </div>
    </div>

    <script>
        // Original SVGs for Tools
        const tools = [
            { id: "Seeds", color: "#f97316", svg: '<circle cx="50" cy="50" r="8" fill="#78350f"/><circle cx="35" cy="40" r="5" fill="#78350f"/><circle cx="65" cy="40" r="5" fill="#78350f"/>' },
            { id: "Spores", color: "#3b82f6", svg: '<circle cx="50" cy="50" r="15" fill="#94a3b8" opacity="0.6"/><circle cx="45" cy="45" r="2" fill="white"/><circle cx="55" cy="55" r="2" fill="white"/>' },
            { id: "Suckers", color: "#a855f7", svg: '<rect x="40" y="30" width="10" height="50" fill="green" rx="2"/><rect x="55" y="55" width="6" height="25" fill="#4ade80" rx="1"/>' },
            { id: "Leaf Cuttings", color: "#ec4899", svg: '<path d="M50 25 Q75 50 50 75 Q25 50 50 25" fill="green"/><circle cx="70" cy="50" r="4" fill="#86efac"/>' },
            { id: "Stem Cuttings", color: "#eab308", svg: '<rect x="47" y="25" width="6" height="50" fill="green"/><path d="M40 45 L60 45" stroke="red" stroke-width="2" stroke-dasharray="2"/>' },
            { id: "Underground Stems", color: "#713f12", svg: '<rect x="10" y="60" width="80" height="20" fill="#a8a29e" opacity="0.5"/><ellipse cx="50" cy="70" rx="15" ry="10" fill="#d97706"/>' }
        ];

        // Vibrant Plant Library
        const plantLibrary = [
            { name: "Durian", method: "Seeds", type: "seed_durian", color1: "#65a30d", color2: "#facc15", hint: "I grow from seeds inside my big, thorny fruit." },
            { name: "Fern", method: "Spores", type: "spore_fern", color1: "#16a34a", color2: "#b45309", hint: "I have dusty brown spores hidden under my leaves." },
            { name: "Banana", method: "Suckers", type: "sucker_tall", color1: "#84cc16", color2: "#fde047", hint: "A little baby plant grows right at my base." },
            { name: "Hibiscus", method: "Stem Cuttings", type: "stem_branch", color1: "#059669", color2: "#f43f5e", hint: "Snipping a branch from me can create a new bush!" },
            { name: "Setawar", method: "Leaf Cuttings", type: "leaf_bud", color1: "#22c55e", color2: "#86efac", hint: "Tiny plantlets sprout all along my leaf edges." },
            { name: "Potato", method: "Underground Stems", type: "underground_tuber", color1: "#854d0e", color2: "#d97706", hint: "The part you eat grows deep under the soil line." },
            { name: "Onion", method: "Underground Stems", type: "underground_bulb", color1: "#9333ea", color2: "#e9d5ff", hint: "I am a round bulb buried beneath the earth." },
            { name: "Ginger", method: "Underground Stems", type: "underground_rhizome", color1: "#15803d", color2: "#fcd34d", hint: "I am a knobby stem that grows sideways underground." },
            { name: "Bamboo", method: "Suckers", type: "sucker_tall", color1: "#22c55e", color2: "#86efac", hint: "We grow in families; new shoots come from the roots." },
            { name: "Rose", method: "Stem Cuttings", type: "stem_branch", color1: "#047857", color2: "#e11d48", hint: "A cutting of my stem is the best way to plant me." }
        ];

        let sessionPlants = [];
        let currentIndex = 0;
        let score = 0;
        let health = 3;
        let isLocked = false;

        const sfx = {
            pop: new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-pop-up-click-sound-2619.mp3'], volume: 0.5 }),
            correct: new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-reward-952.mp3'], volume: 0.6 }),
            wrong: new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-failure-drum-and-light-helipads-612.mp3'], volume: 0.5 }),
            win: new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3'] }),
            confetti: new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-party-popper-fizz-1929.mp3'], volume: 0.4 })
        };

        function createConfetti() {
            sfx.confetti.play();
            for(let i=0; i<40; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.backgroundColor = ['#ef4444', '#22c55e', '#3b82f6', '#eab308', '#a855f7'][Math.floor(Math.random()*5)];
                conf.style.left = '50%';
                conf.style.top = '50%';
                document.getElementById('game-container').appendChild(conf);

                gsap.to(conf, {
                    x: (Math.random() - 0.5) * 600,
                    y: (Math.random() - 0.8) * 500,
                    rotation: Math.random() * 720,
                    opacity: 0,
                    duration: 1.5 + Math.random(),
                    ease: "power2.out",
                    onComplete: () => conf.remove()
                });
            }
        }

        function createPlantSVG(plant) {
            let svg = `<svg viewBox="0 0 100 120" class="w-full h-full drop-shadow-xl">`;
            
            switch(plant.type) {
                case 'seed_durian':
                    svg += `<rect x="46" y="60" width="8" height="40" fill="#854d0e"/><path d="M50 20 L60 35 L75 30 L70 50 L85 60 L65 70 L70 90 L50 80 L30 90 L35 70 L15 60 L30 50 L25 30 L40 35 Z" fill="${plant.color1}"/>`;
                    svg += `<circle cx="50" cy="55" r="12" fill="${plant.color2}"/><circle cx="48" cy="53" r="2" fill="black" opacity="0.4"/>`;
                    break;
                case 'spore_fern':
                    svg += `<path d="M50 100 C30 80 20 50 50 10" fill="none" stroke="${plant.color1}" stroke-width="4"/>`;
                    for(let i=0; i<6; i++) {
                        svg += `<path d="M50 ${20+i*12} Q80 ${10+i*12} 75 ${25+i*12}" fill="${plant.color1}"/>`;
                        svg += `<path d="M50 ${20+i*12} Q20 ${10+i*12} 25 ${25+i*12}" fill="${plant.color1}"/>`;
                        svg += `<circle cx="70" cy="${20+i*12}" r="1.5" fill="${plant.color2}"/>`;
                    }
                    break;
                case 'sucker_tall':
                    svg += `<path d="M45 100 L45 20 Q45 10 55 20 L55 100" fill="${plant.color1}"/>`;
                    svg += `<path d="M60 100 L60 60 Q60 55 65 60 L65 100" fill="${plant.color2}"/>`;
                    break;
                case 'underground_tuber':
                    svg += `<rect x="0" y="80" width="100" height="40" fill="#854d0e" opacity="0.3"/>`;
                    svg += `<path d="M50 80 L50 40 L30 30 M50 50 L70 40" stroke="${plant.color1}" stroke-width="4" fill="none"/>`;
                    svg += `<path d="M40 95 Q50 80 60 95 Q50 110 40 95" fill="${plant.color2}"/>`;
                    break;
                case 'underground_bulb':
                    svg += `<rect x="0" y="80" width="100" height="40" fill="#854d0e" opacity="0.3"/>`;
                    svg += `<path d="M50 80 L50 30" stroke="${plant.color1}" stroke-width="4" fill="none"/>`;
                    svg += `<path d="M35 95 Q50 75 65 95 Q50 115 35 95" fill="${plant.color1}"/>`;
                    break;
                case 'stem_branch':
                    svg += `<rect x="47" y="30" width="6" height="70" fill="${plant.color1}"/>`;
                    svg += `<path d="M30 50 L10 40 M70 60 L90 50" stroke="${plant.color1}" stroke-width="4" fill="none"/>`;
                    svg += `<circle cx="50" cy="30" r="15" fill="${plant.color2}"/>`;
                    break;
                case 'leaf_bud':
                    svg += `<path d="M50 100 L50 30" stroke="${plant.color1}" stroke-width="4"/>`;
                    svg += `<ellipse cx="50" cy="30" rx="30" ry="15" fill="${plant.color1}"/>`;
                    svg += `<circle cx="20" cy="30" r="3" fill="${plant.color2}"/><circle cx="80" cy="30" r="3" fill="${plant.color2}"/>`;
                    break;
                default:
                    svg += `<rect x="47" y="60" width="6" height="40" fill="#854d0e"/><circle cx="50" cy="40" r="25" fill="${plant.color1}"/>`;
                    svg += `<circle cx="50" cy="35" r="10" fill="${plant.color2}"/>`;
            }

            svg += `<text x="50" y="118" text-anchor="middle" font-family="Fredoka One" font-size="11" fill="#15803d" class="drop-shadow-sm">${plant.name}</text></svg>`;
            return svg;
        }

        function initUI() {
            const belt = document.getElementById('tool-belt');
            const infoGrid = document.getElementById('info-grid');
            
            tools.forEach(t => {
                belt.innerHTML += `
                    <button onclick="handleGuess('${t.id}')" class="tool-btn bg-white rounded-2xl p-4 flex flex-col items-center shadow-md">
                        <svg viewBox="0 0 100 100" class="w-10 h-10 mb-2">${t.svg}</svg>
                        <span class="text-[10px] font-black text-gray-600 text-center uppercase tracking-wider">${t.id}</span>
                    </button>
                `;
                infoGrid.innerHTML += `
                    <div class="flex flex-col items-center p-4 bg-green-50 rounded-2xl border-2 border-green-100 shadow-sm">
                        <svg viewBox="0 0 100 100" class="w-12 h-12 mb-2 drop-shadow-sm">${t.svg}</svg>
                        <span class="text-xs font-bold text-green-700">${t.id}</span>
                    </div>
                `;
            });
        }

        function updateHearts() {
            const container = document.getElementById('health-icons');
            container.innerHTML = '';
            for(let i=0; i<3; i++) {
                const active = i < health;
                container.innerHTML += `<svg class="w-8 h-8 ${active ? 'fill-red-500 drop-shadow-sm' : 'fill-gray-300'} transition-colors duration-300" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>`;
            }
        }

        function startGame() {
            sessionPlants = [...plantLibrary].sort(() => Math.random() - 0.5);
            currentIndex = 0;
            score = 0;
            health = 3;
            updateUI();
            
            gsap.to("#overlay", { opacity: 0, pointerEvents: 'none', duration: 0.4, onComplete: loadNextPlant });
        }

        function loadNextPlant() {
            if (currentIndex >= sessionPlants.length) { finishGame(true); return; }
            isLocked = false;
            const plant = sessionPlants[currentIndex];
            const stage = document.getElementById('plant-stage');
            stage.innerHTML = createPlantSVG(plant);
            sfx.pop.play();

            gsap.fromTo(stage, { y: 100, opacity: 0, scale: 0.8 }, { y: 0, opacity: 1, scale: 1, duration: 0.8, ease: "back.out(1.7)" });

            const hint = document.getElementById('hint-bubble');
            document.getElementById('hint-text').innerText = plant.hint;
            gsap.to(hint, { opacity: 1, scale: 1, delay: 0.8, duration: 0.4 });
        }

        function handleGuess(choice) {
            if (isLocked) return;
            isLocked = true;
            const correct = sessionPlants[currentIndex].method;
            gsap.to("#hint-bubble", { opacity: 0, scale: 0.9, duration: 0.2 });

            if (choice === correct) {
                score += 10;
                sfx.correct.play();
                createConfetti(); // Confetti on correct answer
                gsap.to("#plant-stage", { scale: 1.2, opacity: 0, duration: 0.5, onComplete: () => {
                    currentIndex++; updateUI(); loadNextPlant();
                }});
            } else {
                health--;
                sfx.wrong.play();
                updateUI();
                gsap.to("#plant-stage", { x: 10, repeat: 3, yoyo: true, duration: 0.1, onComplete: () => {
                    gsap.set("#plant-stage", { x: 0 });
                    if (health <= 0) finishGame(false);
                    else isLocked = false;
                }});
            }
        }

        function updateUI() {
            document.getElementById('score').innerText = score;
            updateHearts();
            document.getElementById('progress-inner').style.width = `${(currentIndex / sessionPlants.length) * 100}%`;
        }

        function finishGame(won) {
            const overlay = document.getElementById('overlay');
            overlay.style.pointerEvents = 'auto';
            if (won) sfx.win.play();

            overlay.innerHTML = `
                <div class="max-w-xl my-auto">
                    <h1 class="text-8xl bouncy-font text-green-500 mb-4 drop-shadow-md">${won ? 'VICTORY!' : 'GAME OVER'}</h1>
                    <p class="text-2xl text-gray-600 mb-10 font-bold">${won ? 'You are a Master Botanist!' : 'The garden needs more care. Try again!'}</p>
                    <div class="bg-orange-50 p-12 rounded-[3rem] mb-10 border-4 border-orange-200 shadow-inner">
                        <span class="text-sm uppercase font-black text-orange-400 tracking-widest">Final Score</span>
                        <p class="text-9xl bouncy-font text-orange-500 drop-shadow-sm">${score}</p>
                    </div>
                    <button onclick="location.reload()" class="tool-btn bg-green-500 text-white px-16 py-6 rounded-full text-3xl bouncy-font shadow-[0_8px_0_#15803d] active:translate-y-2 active:shadow-none">REPLAY GAME</button>
                </div>
            `;
            gsap.fromTo(overlay, { opacity: 0 }, { opacity: 1, duration: 0.5 });
        }

        window.addEventListener('mousemove', (e) => {
            const moveX = (e.clientX - window.innerWidth / 2) * 0.01;
            gsap.to("#layer-far", { x: moveX * 1, duration: 1.5 });
            gsap.to("#layer-mid", { x: moveX * 2.5, duration: 1 });
        });

        initUI();
        updateHearts();
    </script>
</body>
</html>